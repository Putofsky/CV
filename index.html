<script>
  const canvas = document.getElementById('heatCanvas');
  const ctx = canvas.getContext('2d');
  const size = 30;
  const grid = Array(size).fill().map(() => Array(size).fill(0));

  // Init chaleur au centre
  grid[Math.floor(size/2)][Math.floor(size/2)] = 255;

  function updateGrid() {
    const newGrid = grid.map(arr => arr.slice());
    for (let i = 1; i < size - 1; i++) {
      for (let j = 1; j < size - 1; j++) {
        newGrid[i][j] = (
          grid[i][j] +
          grid[i-1][j] +
          grid[i+1][j] +
          grid[i][j-1] +
          grid[i][j+1]
        ) / 5;
      }
    }
    for (let i = 1; i < size - 1; i++) {
      for (let j = 1; j < size - 1; j++) {
        grid[i][j] = newGrid[i][j];
      }
    }
  }

  function drawGrid() {
    const cellSize = canvas.width / size;
    for (let i = 0; i < size; i++) {
      for (let j = 0; j < size; j++) {
        const value = grid[i][j];
        ctx.fillStyle = `rgb(${value}, 50, 100)`;
        ctx.fillRect(i * cellSize, j * cellSize, cellSize, cellSize);
      }
    }
  }

  function loop() {
    updateGrid();
    drawGrid();
    requestAnimationFrame(loop);
  }

  loop();
</script>
